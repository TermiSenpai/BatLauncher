<Window x:Class="BatLauncher.Views.ToolbarWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:BatLauncher.Converters"
        Title="BatLauncher"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="Manual"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        Topmost="True"
        ShowInTaskbar="True">

    <Window.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVis"/>
        <conv:InverseBoolToVisibilityConverter x:Key="InvBoolToVis"/>
    </Window.Resources>

    <Border Background="#1E1E2E" CornerRadius="14" BorderBrush="#313244" BorderThickness="1"
            Margin="8" MouseLeftButtonDown="Bar_MouseLeftButtonDown">
        <Border.Effect>
            <DropShadowEffect Color="#000000" BlurRadius="20" ShadowDepth="2" Opacity="0.5"/>
        </Border.Effect>

        <StackPanel Orientation="Horizontal" Margin="8,6">

            <!-- Script Icons (scrollable) -->
            <ScrollViewer HorizontalScrollBarVisibility="Hidden"
                          VerticalScrollBarVisibility="Disabled"
                          MaxWidth="600"
                          PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                <ItemsControl x:Name="ScriptItems" ItemsSource="{Binding AllEntries}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Style="{StaticResource ToolbarIconButton}"
                                    ToolTip="{Binding Name}"
                                    Click="ScriptIcon_Click"
                                    Tag="{Binding}">
                                <Border Width="36" Height="36" CornerRadius="8"
                                        Background="#313244">
                                    <Grid>
                                        <TextBlock Text="&#xE756;" FontFamily="Segoe MDL2 Assets"
                                                   FontSize="16" Foreground="#89B4FA"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                                   Visibility="{Binding HasIcon, Converter={StaticResource InvBoolToVis}}"/>
                                        <Image Source="{Binding Icon}" Stretch="Uniform" Margin="4"
                                               RenderOptions.BitmapScalingMode="HighQuality"
                                               Visibility="{Binding HasIcon, Converter={StaticResource BoolToVis}}"/>
                                    </Grid>
                                </Border>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- Separator (only if there are entries) -->
            <Border x:Name="Separator1" Width="1" Height="28" Background="#45475A"
                    Margin="6,0" VerticalAlignment="Center"/>

            <!-- Add Button -->
            <Button Style="{StaticResource ToolbarIconButton}" ToolTip="Add script"
                    Click="Add_Click">
                <Border Width="36" Height="36" CornerRadius="8" Background="#313244">
                    <TextBlock Text="&#xE710;" FontFamily="Segoe MDL2 Assets"
                               FontSize="16" Foreground="#A6E3A1"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
            </Button>

            <!-- Separator -->
            <Border Width="1" Height="28" Background="#45475A"
                    Margin="6,0" VerticalAlignment="Center"/>

            <!-- Open Management Window -->
            <Button Style="{StaticResource ToolbarIconButton}" ToolTip="Manage scripts"
                    Click="Manage_Click">
                <Border Width="36" Height="36" CornerRadius="8" Background="#313244">
                    <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets"
                               FontSize="14" Foreground="#A6ADC8"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
            </Button>

            <!-- Close Button -->
            <Button Style="{StaticResource ToolbarCloseButton}" ToolTip="Close"
                    Click="Close_Click">
                <Border Width="28" Height="28" CornerRadius="6">
                    <TextBlock Text="&#xE711;" FontFamily="Segoe MDL2 Assets"
                               FontSize="9" Foreground="#6C7086"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
            </Button>
        </StackPanel>
    </Border>
</Window>
